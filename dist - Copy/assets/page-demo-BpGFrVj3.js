import{r as a,j as e,z as L,P as v,S as d,B as x,y as l,A as q,D as B,E as f,F as n,H as R}from"./vendor-DFbu7K4o.js";function u(t){return typeof t=="string"?t.toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "):t}function z(t,o="TZS",i="en-US"){const h=typeof t=="string"?parseFloat(t):t;return isNaN(h)?"Invalid Amount":h.toLocaleString(i,{style:"currency",currency:o})}function g(t,o){let i;if(typeof t=="string"){const c=parseFloat(t);if(isNaN(c))return"Invalid Number";i=c}else i=t;return i.toLocaleString(void 0,{...o,minimumFractionDigits:2,maximumFractionDigits:2})}function k(t){return t.reduce((o,i)=>{const h=typeof i.total_price=="string"?parseFloat(i.total_price):i.total_price;return o+(isNaN(h)?0:h)},0)}function H(t){const o="https://dentallab-vg4w.onrender.com",[i,h]=a.useState(t.caseId),[c,j]=a.useState([]),[W,C]=a.useState(null),[p,T]=a.useState(null),[m,I]=a.useState(""),[E,b]=a.useState(null),[y,w]=a.useState(null),S=t.docttypee,F=t.discount,P=t.bill_date,_=t.billend,A=t.additionalcost,U=t.docnumber,N=k(c),$=parseInt(A)+N-parseInt(F);return a.useEffect(()=>{(async()=>{if(i)try{fetch(`${o}/cases/${i}`,{method:"GET"}).then(r=>r.status===200?r.json():null).then(r=>{r!==null&&(b(r),console.log(r))})}catch(r){console.error("Error fetching case:",r),b(null)}else b(null)})()},[i]),a.useEffect(()=>{(async()=>{if(i)try{const r=await fetch(`${o}/task-info/patient/${i}`);if(r.ok){const D=await r.json();j(D)}else console.error("Failed to fetch patients:",r.status),j([])}catch(r){console.error("Error fetching patients:",r),j([])}else j([])})()},[i]),a.useEffect(()=>{c&&c.length>0?(T(c[0].doctor.toLocaleUpperCase()),C(c[0].caseNumber),I(c[0].entity_name)):(T(null),C(null),I(""))},[c]),a.useEffect(()=>{p&&fetch(`${o}/clients/${p}`,{method:"GET"}).then(s=>s.status===200?s.json():null).then(s=>{s!==null&&w(s)})},[p]),e.jsx(L,{component:v,children:e.jsx(d,{sx:{border:0},children:e.jsxs(d,{spacing:2,direction:"column",sx:{width:700,margin:"50px auto",p:2,border:3},children:[e.jsxs(x,{sx:{border:0},children:[m&&e.jsx(l,{sx:{textAlign:"center",fontSize:36,fontWeight:"bold",fontFamily:"sans-serif",fontStyle:"inherit",mb:7},children:m.toUpperCase()})," ",e.jsx(l,{sx:{textAlign:"center",fontSize:24,fontWeight:"bold",fontFamily:"sans-serif",fontStyle:"inherit",mb:5},children:S.toUpperCase()})]}),W&&e.jsxs(d,{spacing:2,direction:"row",children:[e.jsxs(l,{sx:{textAlign:"center",fontWeight:"bold",fontFamily:"sans-serif",fontStyle:"inherit"},children:[u(S)," Number:"]}),e.jsx(l,{sx:{m:0},children:U})]}),y&&e.jsxs(d,{spacing:2,direction:"row",children:[e.jsx(l,{sx:{textAlign:"center",fontWeight:"bold",fontFamily:"sans-serif",fontStyle:"inherit"},children:S=="invoice"?"Payer   :":"Received From :"}),e.jsxs(l,{sx:{border:0,paddingLeft:2},children:[u(y.fullName),","," ",u(y.office)]})]}),E&&e.jsxs(d,{spacing:2,direction:"row",children:[e.jsx(l,{sx:{textAlign:"center",fontWeight:"bold",fontFamily:"sans-serif",fontStyle:"inherit"},children:"Patient :"}),e.jsx(l,{sx:{border:0,paddingLeft:8},children:u(E.patient)})]}),e.jsx(x,{sx:{border:1}}),e.jsxs(q,{"aria-label":"spanning table",children:[e.jsx(B,{children:e.jsxs(f,{children:[e.jsx(n,{children:"Teeth"}),e.jsx(n,{children:"Product"}),e.jsx(n,{align:"right",children:"Qty."}),e.jsx(n,{align:"right",children:"Unit"}),e.jsx(n,{align:"right",children:"Sum"})]})}),e.jsxs(R,{children:[c.map(s=>e.jsxs(f,{children:[e.jsx(n,{children:s.teeth}),e.jsx(n,{children:s.product}),e.jsx(n,{align:"right",children:s.quantity}),e.jsx(n,{align:"right",children:g(s.price)}),e.jsx(n,{align:"right",children:g(s.total_price)})]},s.id)),e.jsxs(f,{children:[e.jsx(n,{rowSpan:5}),e.jsx(n,{colSpan:3,children:"Subtotal"}),e.jsx(n,{align:"right",children:g(N)})]}),e.jsxs(f,{children:[e.jsx(n,{children:"Discount"}),e.jsx(n,{align:"right",children:`${parseInt(F).toFixed(0)}`}),e.jsx(n,{align:"right",colSpan:3,children:g(parseInt(F))})]}),e.jsxs(f,{children:[e.jsx(n,{children:"Addittional Cost"}),e.jsx(n,{align:"right",children:`${parseInt(A).toFixed(0)}`}),e.jsx(n,{align:"right",colSpan:3,children:g(parseInt(A))})]}),e.jsxs(f,{children:[e.jsx(n,{colSpan:3,children:"Total"}),e.jsx(n,{sx:{fontStyle:"inherit",fontWeight:"bold"},align:"right",children:z($)})]})]})]}),e.jsxs(x,{sx:{border:0},children:[e.jsxs(d,{spacing:2,direction:"row",sx:{mt:2},children:[e.jsx(l,{sx:{textAlign:"left",fontWeight:"bold",fontFamily:"sans-serif",fontStyle:"inherit",mb:1},children:"Created At :"}),e.jsx(l,{sx:{textAlign:"left",fontWeight:"bold",fontFamily:"sans-serif",fontStyle:"inherit",mb:1},children:P})]})," ",e.jsxs(d,{spacing:2,direction:"row",sx:{mt:2},children:[e.jsx(l,{sx:{textAlign:"left",fontWeight:"bold",fontFamily:"sans-serif",fontStyle:"inherit"},children:"Expires On:"}),e.jsx(l,{sx:{textAlign:"left",fontWeight:"bold",fontFamily:"sans-serif",fontStyle:"inherit"},children:_})]})," ",e.jsxs(d,{direction:"row",sx:{mt:2,display:"flex",justifyContent:"space-between"},children:[e.jsxs(l,{sx:{textAlign:"left",fontWeight:"bold",fontFamily:"sans-serif",fontStyle:"inherit",mb:1},children:["Prepared By: ","Admin"]}),e.jsx(l,{sx:{textAlign:"center",fontWeight:"bold",fontFamily:"sans-serif",fontStyle:"inherit",mb:1,color:"GrayText"},children:"How To Pay Contacts +255 000 000 000 "})," "]})," "]}),e.jsx(x,{sx:{border:1}}),e.jsx(x,{sx:{display:"flex",justifyContent:"center"},children:e.jsx("footer",{children:e.jsxs("p",{children:["Â© ",new Date().getFullYear(),"|",u(m),". All rights reserved."]})})})]})})})}export{H as S};
