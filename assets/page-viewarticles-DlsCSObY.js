import{r as a,j as t,y as X,g,J as b,o as A,A as T,a3 as Y,D as F,a as $,b as W,T as C,a4 as B,B as m,k as Z,I,a5 as ee,a6 as te}from"./vendor-BrzHSOkp.js";function se(){const f="https://jikuclass.onrender.com/api/articles",[O,P]=a.useState([]),[l,r]=a.useState(!0),[x,j]=a.useState(null),[z,k]=a.useState(!1),[d,w]=a.useState(null),[i,S]=a.useState({title:"",body:"",type:""}),[L,N]=a.useState(!1),[n,D]=a.useState(null),[R,E]=a.useState(!1),[M,H]=a.useState(""),[J,U]=a.useState("success"),o=a.useCallback(async()=>{r(!0),j(null);try{const e=await fetch(f);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const s=await e.json();P(s)}catch(e){console.error("Failed to fetch articles:",e),j(`Failed to load articles: ${e.message}`),c(`Failed to load articles: ${e.message}`,"error")}finally{r(!1)}},[]);a.useEffect(()=>{o()},[o]);const V=a.useCallback(e=>{w(e),S({title:e.title,body:e.body,type:e.type}),k(!0)},[]),u=a.useCallback(()=>{k(!1),w(null)},[]),p=a.useCallback(e=>{const{name:s,value:y}=e.target;S(Q=>({...Q,[s]:y}))},[]),_=a.useCallback(async()=>{if(d){r(!0);try{const e={...d,...i},s=await fetch(`${f}/${d.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok){const y=await s.json();throw new Error(`Failed to update article: ${y.message||s.statusText}`)}c("Article updated successfully!","success"),u(),o()}catch(e){console.error("Failed to update article:",e),c(`Error updating article: ${e.message}`,"error")}finally{r(!1)}}},[d,i,u,o]),G=a.useCallback(e=>{D(e),N(!0)},[]),h=a.useCallback(()=>{N(!1),D(null)},[]),q=a.useCallback(async()=>{if(n){r(!0);try{const e=await fetch(`${f}/${n.id}`,{method:"DELETE"});if(!e.ok)throw new Error(`Failed to delete article: ${e.statusText}`);c("Article deleted successfully!","success"),h(),o()}catch(e){console.error("Failed to delete article:",e),c(`Error deleting article: ${e.message}`,"error")}finally{r(!1)}}},[n,h,o]),c=a.useCallback((e,s)=>{H(e),U(s),E(!0)},[]),v=a.useCallback((e,s)=>{s!=="clickaway"&&E(!1)},[]),K=[{field:"id",headerName:"ID",width:60},{field:"title",headerName:"Title",flex:1,minWidth:150},{field:"body",headerName:"Body",flex:2,minWidth:200},{field:"type",headerName:"Type",width:100},{field:"postDate",headerName:"Post Date",width:200},{field:"actions",type:"actions",headerName:"Actions",width:150,getActions:e=>[t.jsx(I,{"aria-label":"edit",onClick:()=>V(e.row),color:"primary",children:t.jsx(ee,{})},"edit"),t.jsx(I,{"aria-label":"delete",onClick:()=>G(e.row),color:"error",children:t.jsx(te,{})},"delete")]}];return t.jsxs(X,{maxWidth:"lg",className:"py-8",children:[t.jsxs(g,{className:"flex flex-col items-center justify-center p-4 bg-white rounded-lg shadow-lg",children:[l&&t.jsxs(g,{className:"flex justify-center items-center h-48",children:[t.jsx(b,{}),t.jsx(A,{variant:"h6",className:"ml-4",children:"Loading Articles..."})]}),x&&t.jsx(T,{severity:"error",className:"w-full mb-4",children:x}),!l&&!x&&t.jsxs(g,{className:"w-full h-[600px] rounded-lg overflow-hidden",children:[" ",t.jsx(Y,{rows:O,columns:K,getRowId:e=>e.id,initialState:{pagination:{paginationModel:{pageSize:10,page:0}}},pageSizeOptions:[5,10,20],disableRowSelectionOnClick:!0,className:"rounded-lg"})]})]}),t.jsxs(F,{open:z,onClose:u,fullWidth:!0,maxWidth:"sm",children:[t.jsx($,{className:"bg-blue-500 text-white rounded-t-lg font-inter",children:"Edit Article"}),t.jsxs(W,{className:"p-6",children:[t.jsx(C,{autoFocus:!0,margin:"dense",name:"title",label:"Title",type:"text",fullWidth:!0,variant:"outlined",value:i.title,onChange:p,className:"mb-4"}),t.jsx(C,{margin:"dense",name:"body",label:"Body",type:"text",fullWidth:!0,multiline:!0,rows:4,variant:"outlined",value:i.body,onChange:p,className:"mb-4"}),t.jsx(C,{margin:"dense",name:"type",label:"Type",type:"text",fullWidth:!0,variant:"outlined",value:i.type,onChange:p})]}),t.jsxs(B,{className:"p-4 border-t border-gray-200",children:[t.jsx(m,{onClick:u,color:"secondary",variant:"outlined",className:"rounded-md",children:"Cancel"}),t.jsx(m,{onClick:_,color:"primary",variant:"contained",className:"rounded-md",disabled:l,children:l?t.jsx(b,{size:24}):"Save Changes"})]})]}),t.jsxs(F,{open:L,onClose:h,maxWidth:"xs",children:[t.jsx($,{className:"bg-red-500 text-white rounded-t-lg font-inter",children:"Confirm Delete"}),t.jsx(W,{className:"p-6",children:t.jsxs(A,{children:['Are you sure you want to delete the article "',n==null?void 0:n.title,'"? This action cannot be undone.']})}),t.jsxs(B,{className:"p-4 border-t border-gray-200",children:[t.jsx(m,{onClick:h,color:"secondary",variant:"outlined",className:"rounded-md",children:"Cancel"}),t.jsx(m,{onClick:q,color:"error",variant:"contained",className:"rounded-md",disabled:l,children:l?t.jsx(b,{size:24}):"Delete"})]})]}),t.jsx(Z,{open:R,autoHideDuration:6e3,onClose:v,children:t.jsx(T,{onClose:v,severity:J,sx:{width:"100%"},children:M})})]})}export{se as V};
