import{r as n,w as _,j as r,y as F,h as m,K as G,p as j,A as W,G as A,d as K,L as O,e as Q,I as C,P as X,N as q,O as L,V as J,Q as Y,R as Z}from"./vendor-FkN5RzXv.js";const I=f=>{const i=Math.floor(f/60),x=Math.floor(f%60);return`${i}:${x<10?"0":""}${x}`},re=({defaultAudioType:f})=>{const[i,x]=n.useState([]),[y,D]=n.useState(!0),[h,M]=n.useState(null),[k,ee]=n.useState(f||"utangulizi"),E="https://c.mamed.org/rent/get_audios.php",[s,g]=n.useState(null),[T,v]=n.useState({}),[b,V]=n.useState({}),[d,P]=n.useState(1),[p,S]=n.useState(!1),u=n.useRef([]),[w,R]=n.useState({}),$=_({palette:{mode:"dark"}});n.useEffect(()=>{(async()=>{try{const e=await fetch(`${E}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const a=(await e.json()).filter(l=>l.type===k);x(a)}catch(e){console.log(E),console.error("Failed to fetch audio data:",e),M(`Failed to load audio data: ${e.message}`)}finally{D(!1)}})()},[f]),n.useEffect(()=>{u.current=i.map(()=>null)},[i]),n.useEffect(()=>{if(s!==null&&i.length>0){const t=u.current[s];if(t){w[s]||(t.src=i[s].url,R(c=>({...c,[s]:!0}))),t.volume=p?0:d;const e=()=>{t.play().catch(c=>{console.error("Playback failed:",c),g(null)})};w[s]&&e();const o=()=>{v(c=>({...c,[s]:t.currentTime}))},a=()=>{V(c=>({...c,[s]:t.duration}))},l=()=>{g(null),v(c=>({...c,[s]:0}))};return t.addEventListener("canplay",e),t.addEventListener("timeupdate",o),t.addEventListener("loadedmetadata",a),t.addEventListener("ended",l),()=>{t.removeEventListener("canplay",e),t.removeEventListener("timeupdate",o),t.removeEventListener("loadedmetadata",a),t.removeEventListener("ended",l),t.pause()}}}u.current.forEach((t,e)=>{e!==s&&t&&t.pause()})},[s,d,p,w,i]);const z=t=>{g(s===t?null:t)},B=(t,e,o)=>{const a=typeof e=="number"?e:e[0];if(P(a),s!==null){const l=u.current[s];l&&(l.volume=a)}S(a===0)},N=()=>{S(t=>{const e=!t,o=e?0:d>0?d:.5;if(s!==null){const a=u.current[s];a&&(a.volume=o)}return!e&&d===0&&P(.5),e})},H=(t,e)=>{const o=typeof e=="number"?e:e[0];if(s!==null){const a=u.current[s];a&&(a.currentTime=o,v(l=>({...l,[s]:o})))}},U=()=>p||d===0?r.jsx(J,{}):d<.5?r.jsx(Y,{}):r.jsx(Z,{});return r.jsx(F,{theme:$,children:r.jsxs(m,{sx:{padding:"2",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",mt:8},children:[y&&r.jsxs(m,{sx:{display:"flex",flexDirection:"column",alignItems:"center",color:"#fff"},children:[r.jsx(G,{color:"success"}),r.jsx(j,{sx:{marginTop:"1rem"},children:"Loading audio data..."})]}),h&&r.jsx(W,{severity:"error",sx:{width:"80%",maxWidth:"600px",marginBottom:"2rem"},children:h}),!y&&!h&&i.length===0&&r.jsx(j,{sx:{color:"#fff",marginTop:"2rem"},children:"No audio files available."}),!y&&!h&&i.length>0&&r.jsx(A,{container:!0,spacing:4,sx:{justifyContent:"flex-start",alignItems:"flex-start"},children:i.map((t,e)=>r.jsx(A,{item:!0,xs:12,sm:6,md:4,children:r.jsxs(K,{sx:{backgroundColor:"#1e1e1e",color:"#fff",transition:"transform 0.3s ease, box-shadow 0.3s ease","&:hover":{transform:"scale(1.02)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)"},borderRadius:"0.5rem"},children:[r.jsx(O,{title:t.title,sx:{color:"#fff",textAlign:"center",paddingBottom:"0.5rem","& .MuiCardHeader-title":{fontSize:"1.2rem",fontWeight:500}}}),r.jsxs(Q,{sx:{display:"flex",flexDirection:"column",alignItems:"center",paddingTop:0},children:[r.jsx("audio",{ref:o=>{o&&(u.current[e]=o)},hidden:!0}),r.jsxs(m,{sx:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",paddingX:"1rem"},children:[r.jsx(C,{onClick:()=>z(e),"aria-label":s===e?"Pause":"Play",sx:{fontSize:"3rem",color:"#fff","&:hover":{color:"#f50057"}},children:s===e?r.jsx(X,{sx:{fontSize:"3rem"}}):r.jsx(q,{sx:{fontSize:"3rem"}})}),r.jsxs(m,{sx:{width:"100%",display:"flex",alignItems:"center",gap:"1rem",marginTop:"1rem"},children:[r.jsx(j,{variant:"caption",color:"textSecondary",sx:{color:"#fff"},children:I(T[e]||0)}),r.jsx(L,{max:b[e]||0,value:T[e]||0,onChange:H,"aria-label":"progress",sx:{width:"100%",color:"#fff","& .MuiSlider-thumb":{width:16,height:16}}}),r.jsx(j,{variant:"caption",color:"textSecondary",sx:{color:"#fff"},children:I(b[e]||0)})]}),r.jsxs(m,{sx:{display:"flex",alignItems:"center",gap:"1rem",marginTop:"1rem"},children:[r.jsx(C,{onClick:N,"aria-label":"Volume",sx:{color:"#fff"},children:U()}),r.jsx(L,{value:p?0:d,onChange:B,"aria-label":"volume",max:1,step:.01,sx:{width:100,color:"#fff","& .MuiSlider-thumb":{width:12,height:12}}})]})]})]})]})},t.id))})]})})};export{re as A};
