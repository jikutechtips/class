import{c as F,r as a,m as M,j as t,D as L,a as Y,I as H,C as U,b as V,B as J,T as S,d as s,e as W,f as $,g as G,A as K}from"./vendor-Q_I1QV0S.js";const P="https://dental-clinic-latest.onrender.com",X=({open:T,onClose:o})=>{F();const[l,w]=a.useState(""),[c,A]=a.useState(""),[d,z]=a.useState(""),[u,R]=a.useState(""),[x,N]=a.useState(""),[m,B]=a.useState(""),[h,D]=a.useState(""),[g,O]=a.useState(""),[f,q]=a.useState(""),[v,E]=a.useState(""),[k,C]=a.useState(!1),[_,i]=a.useState(""),[y,p]=a.useState(!1),b=(e,r)=>{r!=="clickaway"&&C(!1)},j=M().tz("Africa/Nairobi").format("YYYY-MM-DDTHH:mm:ss"),I=async()=>{if(l===""||u===""||x===""||f===""||g===""){i("Some fields are not filled. Please fill all required fields to continue.");return}if(c.length<12){i("Clinic Address should be in the format: P.O. Box 123, City, Region");return}if(d.length<11){i("Clinic Phone Number must include the country code (e.g., 255 for Tanzania).");return}if(m.length<12){i("Physical Address should be in the format: P.O. Box 123, City, Region");return}if(h.length<11){i("Phone number must include the country code (e.g., 255 for Tanzania).");return}p(!0),i("");try{const e=await fetch(`${P}/clinics`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({clinicname:l,clinicaddress:c,clinicemail:u.toLowerCase(),clinicphone:d,tax:v,clinic_reg_date:j})});if(e.status===201){const n=await e.json();console.log("Clinic registration successful:",n)}else{const n=await e.text();console.error("Clinic registration failed:",n),i(n),p(!1);return}const r=await fetch(`${P}/users`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({fullName:x,address:m,phone_number:h,email:g.toLowerCase(),password:f,title:"Admin",entity_name:l,registration_date:j})});if(r.status===201){const n=await r.json();console.log("User registration successful:",n),C(!0),o()}else{const n=await r.text();console.error("User registration failed:",n),i(n)}}catch(e){console.error("Error during registration:",e),i("A network error occurred.")}finally{p(!1)}};return t.jsxs(L,{open:T,onClose:o,fullWidth:!0,maxWidth:"md",children:[t.jsxs(Y,{children:["Register",t.jsx(H,{"aria-label":"close",onClick:o,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:t.jsx(U,{})})]}),t.jsxs(V,{children:[t.jsxs(J,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:"25ch"}},noValidate:!0,autoComplete:"off",children:[t.jsx(S,{variant:"h6",gutterBottom:!0,children:"Clinic Information"}),t.jsxs("div",{children:[t.jsx("p",{style:{color:"red",fontSize:"14px"},children:_}),t.jsx(s,{id:"clincname",label:"Clinic Name",value:l,onChange:e=>w(e.target.value),type:"text",variant:"outlined",size:"small",required:!0}),t.jsx(s,{id:"clinicaddress",label:"Clinic Address",helperText:"P.O. Box 123, City, Region",type:"text",value:c,onChange:e=>A(e.target.value),variant:"outlined",size:"small",required:!0}),t.jsx(s,{id:"clinicphone",label:"Clinic Phone Number",type:"tel",helperText:"+2557xxxxxxxx",onChange:e=>z(e.target.value),value:d,size:"small",variant:"outlined",required:!0}),t.jsx(s,{id:"clinicemail",label:"Clinic Email Address",type:"email",onChange:e=>R(e.target.value),value:u,variant:"outlined",size:"small",required:!0}),t.jsx(s,{id:"tin",size:"small",label:"Tax/Reg No ......(Optional)",type:"text",onChange:e=>E(e.target.value),value:v,variant:"outlined"})]}),t.jsx("br",{}),t.jsxs("div",{children:[t.jsx(S,{variant:"h6",gutterBottom:!0,children:"Administration Information"}),t.jsx(s,{id:"fullname",label:"Full Name",onChange:e=>N(e.target.value),type:"text",value:x,size:"small",variant:"outlined",required:!0}),t.jsx(s,{id:"address",label:"Physical Address",helperText:"P.O. Box 123, City, Region",type:"text",size:"small",onChange:e=>B(e.target.value),value:m,variant:"outlined",required:!0}),t.jsx(s,{id:"phone-number",value:h,onChange:e=>D(e.target.value),label:"Phone Number",helperText:"2557xxxxxxxx",type:"tel",size:"small",variant:"outlined",required:!0}),t.jsx(s,{id:"email",label:"Email Address",value:g,onChange:e=>O(e.target.value),type:"email",size:"small",variant:"outlined",required:!0}),t.jsx(s,{id:"password",label:"Password",onChange:e=>q(e.target.value),type:"password",size:"small",value:f,variant:"outlined",required:!0})]}),t.jsx(W,{sx:{textTransform:"none",mt:2},variant:"contained",onClick:I,disabled:y,children:y?t.jsx($,{size:24,sx:{color:"white"}}):"Register"})]}),t.jsx(G,{open:k,autoHideDuration:1500,onClose:b,children:t.jsx(K,{onClose:b,severity:"success",variant:"filled",sx:{width:"100%"},children:"Registration successful!"})})]})]})};export{X as R};
