import{r as s,u as E,j as l,U as S,ao as h}from"../vendor-BrzHSOkp.js";import{A as w}from"../page-shared-theme/AppTheme-CjX0rGq9.js";import{u as y}from"../page-chooseclass-Dq1AN_te.js";function b(d){const u="https://jikuclass.onrender.com";console.log("SignInSide component rendered");const[A,x]=s.useState(!1),[v,I]=s.useState(""),[P,a]=s.useState(!1),[j,_]=s.useState(!1),[k,N]=s.useState(""),[C,L]=s.useState(!1),[,p]=s.useState(""),[M,o]=s.useState(null),m=async c=>{a(!0);const n=c.get("email"),i=c.get("password");if(!n||!i)throw a(!1),new Error("Email and password are required.");const t={email:n,password:i};try{const r=await fetch(`${u}/api/users/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(r.ok){const e=await r.json();return p(e.fullName),a(!1),{user:{name:e.fullName,email:e.email,image:"https://c.mamed.org/images/jikulogo",title:e.title,entity_name:e.entity_name,phone:e.phone,address:e.address,itExperience:e.itExperience,birthYear:e.birthYear,academy:e.academy,practice:e.practice,inventory:e.inventory,createdAt:e.createdAt,updateAt:e.updateAt,paymentStatus:e.paymentStatus}}}else if(r.status===401){a(!1);const e=await r.text();throw o(e||"Invalid credentials."),new Error(e||"Invalid credentials.")}else{a(!1);const e=await r.text();throw o(`Login failed: ${r.status} - ${e||"An unexpected error occurred"}`),new Error(`Login failed: ${r.status} - ${e||"An unexpected error occurred"}`)}}catch(r){throw a(!1),console.error("Error during login API call:",r),r instanceof TypeError&&r.message==="Failed to fetch"?(o("Network error: Could not connect to the server. Please check your API_BASE_URL and server status."),new Error("Network error: Could not connect to the server. Please check your API_BASE_URL and server status.")):(o(r.message||"An unexpected error occurred during login."),r)}},{setSession:g}=y(),f=E();return l.jsxs(w,{...d,children:[l.jsx(S,{enableColorScheme:!0}),l.jsx(h,{providers:[{id:"credentials",name:"Credentials"}],signIn:async(c,n,i)=>{try{const t=await m(n);if(t)return g(t),f(i||"/",{replace:!0}),{}}catch(t){return{error:t instanceof Error?t.message:"An error occurred"}}return{}}})]})}export{b as S};
